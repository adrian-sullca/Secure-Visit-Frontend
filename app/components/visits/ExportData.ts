import jsPDF from "jspdf";
import autoTable from "jspdf-autotable";
import * as XLSX from "xlsx";
import { User } from "~/types/user.types";
import { VisitFormatted } from "~/types/visits.types";

export const exportToPDF = (visits: VisitFormatted[], user: User) => {
  const logoBase64 =
    "data:image/jpeg;base64,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";

  const doc = new jsPDF();

  doc.addImage(logoBase64, "PNG", 165, 15, 30, 10);

  doc.setFontSize(16);
  doc.setFont("helvetica", "bold");
  doc.text("Reporte de visitas", 15, 20);
  doc.setFontSize(10);
  doc.setFont("helvetica", "normal");
  doc.text(`Fecha:   ${new Date().toLocaleDateString()}`, 15, 26);
  doc.text(`Usuario: ${user.name}`, 15, 30);
  doc.line(15, 34, 195, 34);

  const tableColumn = [
    "Visita",
    "Fecha ingreso",
    "Hora ingreso",
    "Fecha salida",
    "Hora salida",
    "Nombre",
    "Apellido",
    "Email",
  ];

  const tableRows = visits.map((visit) => [
    visit.visit_type,
    visit.date_entry_formatted,
    visit.time_entry,
    visit.date_exit_formatted,
    visit.time_exit,
    visit.visit_name,
    visit.visit_surname,
    visit.visit_email,
  ]);

  autoTable(doc, {
    head: [tableColumn],
    body: tableRows,
    startY: 40,
    styles: {
      fontSize: 9,
      cellPadding: 2,
    },
    headStyles: {
      fillColor: [22, 117, 224],
      textColor: 255,
    },
  });

  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth() + 1).padStart(2, "0");
  const dd = String(today.getDate()).padStart(2, "0");
  const fileName = `visitas-${yyyy}-${mm}-${dd}.pdf`;

  doc.save(fileName);
};

export const exportToExcel = (visits: VisitFormatted[], user: User) => {
  const worksheet = XLSX.utils.json_to_sheet([
    { Usuario: user.name },
    {},
    ...visits,
  ]);
  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, "Visitas");

  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth() + 1).padStart(2, "0");
  const dd = String(today.getDate()).padStart(2, "0");
  const fileName = `visitas-${yyyy}-${mm}-${dd}.xlsx`;

  XLSX.writeFile(workbook, fileName);
};
